
<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Openlava Import &mdash; LavaFlow 1.1 documentation</title>
    
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-3.1.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-3.1.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="LavaFlow 1.1 documentation" href="index.html" />
    <link rel="next" title="Views" href="views.html" />
    <link rel="prev" title="Web Server Installation" href="install.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          LavaFlow</a>
        <span class="navbar-text navbar-version pull-left"><b>1.1</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Web Server Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Openlava Import</a></li>
<li class="toctree-l1"><a class="reference internal" href="views.html">Views</a></li>
<li class="toctree-l1"><a class="reference internal" href="models.html">Models</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Openlava Import</a><ul>
<li><a class="reference internal" href="#installataion">Installataion</a><ul>
<li><a class="reference internal" href="#openlava-python-bindings">Openlava-python bindings</a></li>
<li><a class="reference internal" href="#download-lavaflow">Download lavaFlow</a></li>
</ul>
</li>
<li><a class="reference internal" href="#lava-import-openlava-py">lava-import-openlava.py</a></li>
<li><a class="reference internal" href="#importing-guidelines">Importing Guidelines</a><ul>
<li><a class="reference internal" href="#post-installation">Post Installation</a></li>
<li><a class="reference internal" href="#automatic-import">Automatic Import</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="install.html" title="Previous Chapter: Web Server Installation"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm">&laquo; Web Server Insta...</span>
    </a>
  </li>
  <li>
    <a href="views.html" title="Next Chapter: Views"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm">Views &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="_sources/import.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="openlava-import">
<h1>Openlava Import<a class="headerlink" href="#openlava-import" title="Permalink to this headline">¶</a></h1>
<p>lavaFlow comes with a script that will read OpenLava log files, and upload data to the lavaFlow server, this tool can
continuously in the background, or via a cron job, or manually as required.</p>
<div class="section" id="installataion">
<h2>Installataion<a class="headerlink" href="#installataion" title="Permalink to this headline">¶</a></h2>
<div class="section" id="openlava-python-bindings">
<h3>Openlava-python bindings<a class="headerlink" href="#openlava-python-bindings" title="Permalink to this headline">¶</a></h3>
<p>In order to read and upload log files, you need to install the openlava python bindings.  These are used only by the
upload tools, generally you only need to install this on the master node of each cluster, this may or may not be the
machine you are running lavaFlow on.</p>
<p>Install the Openlava python bindings.:</p>
<div class="highlight-python"><pre>$ git clone https://github.com/irvined1982/openlava-python.git
$ cd openlava-python/openlava/
$ python setup.py install</pre>
</div>
</div>
<div class="section" id="download-lavaflow">
<h3>Download lavaFlow<a class="headerlink" href="#download-lavaflow" title="Permalink to this headline">¶</a></h3>
<p>Use git to checkout <a class="reference external" href="https://github.com/irvined1982/lavaFlow">lavaFlow</a>.:</p>
<div class="highlight-python"><pre>$ git clone https://github.com/irvined1982/lavaflow.git
$ git submodule update --init --recursive</pre>
</div>
<p>Inside the import directory you will find the import scripts.</p>
</div>
</div>
<div class="section" id="lava-import-openlava-py">
<h2>lava-import-openlava.py<a class="headerlink" href="#lava-import-openlava-py" title="Permalink to this headline">¶</a></h2>
<p>Reads openlava log files and uploads them.  Will read and attempt to upload all entries in the file.
This is not desirable if you have large logfiles and want to upload regularly, for that you should use
logtail or some other utility to only read entries that have not yet been uploaded.  There is no harm in
re-uploading, but it is time expensive.:</p>
<div class="highlight-python"><pre>usage: lava-import-openlava.py [-h] [--tail_log] [--cluster_name NAME]
                               [--chunk_size CHUNK_SIZE]
                               [--log_level LOG_LEVEL] [--retry_forever]
                               LOGFILE URL KEY</pre>
</div>
<dl class="option">
<dt>
<tt class="descname">log_file</tt></dt>
<dd></dd></dl>

<p>The path to the log file to read, should be one of lsb.acct or lsb.events*</p>
<dl class="option">
<dt>
<tt class="descname">url</tt></dt>
<dd></dd></dl>

<p>Fully qualified URL to the lavaflow server.</p>
<dl class="option">
<dt>
<tt class="descname">key</tt></dt>
<dd></dd></dl>

<p>Pre shared key that will be used to verify the client has permission to publish to the server.</p>
<dl class="option">
<dt>
<tt class="descname">tail_log</tt></dt>
<dd></dd></dl>

<p>When enabled, will not exit when the end of the input file is reached.  Instead, it will wait for new data,
or if the file is rotated, reopen the file and continue reading.</p>
<dl class="option">
<dt>
<tt class="descname">cluster_name</tt></dt>
<dd></dd></dl>

<p>Optional name of the cluster, if no cluster name is specified, will attempt to infer cluster name from openlava
directly.</p>
<dl class="option">
<dt>
<tt class="descname">chunk_size</tt></dt>
<dd></dd></dl>

<p>Number of records to group together before sending to server.</p>
<dl class="option">
<dt>
<tt class="descname">log_level</tt></dt>
<dd></dd></dl>

<p>Log level to use, can be one of debug, info, warn, error, critical.</p>
<p>When enabled, will not exit when the end of the input file is reached.  Instead, it will wait for new data,
or if the file is rotated, reopen the file and continue reading.</p>
</div>
<div class="section" id="importing-guidelines">
<h2>Importing Guidelines<a class="headerlink" href="#importing-guidelines" title="Permalink to this headline">¶</a></h2>
<div class="section" id="post-installation">
<h3>Post Installation<a class="headerlink" href="#post-installation" title="Permalink to this headline">¶</a></h3>
<p>After completing the installation, you need to populate the database, generally it is best to pull all lsb.event
files and the lsb.acct file into lavaFlow.  It doesnt matter which you do first. Something like the following:</p>
<div class="highlight-python"><pre>$ ./import/lava-import-openlava.py /opt/openlava/work/logdir/lsb.events https://OPENLAVA_SERVER/lavaFlow T0PS3CRETK3YFILE --chunk_size=1000 --log_level=info
$ for i in /opt/openlava/work/logdir/lsb.events
&gt; do
&gt; ./import/lava-import-openlava.py $i https://OPENLAVA_SERVER/lavaFlow T0PS3CRETK3YFILE --chunk_size=1000 --log_level=info
&gt; done
$</pre>
</div>
</div>
<div class="section" id="automatic-import">
<h3>Automatic Import<a class="headerlink" href="#automatic-import" title="Permalink to this headline">¶</a></h3>
<p>Once the database has been populated with a backlog of events, you need to continue to add new data when it becomes
available.  For this you can use the tail_log option.  Something like the following:</p>
<div class="highlight-python"><pre>$ ./import/lava-import-openlava.py /opt/openlava/work/logdir/lsb.acct https://OPENLAVA_SERVER/lavaFlow T0PS3CRETK3YFILE --tail_log &amp;
$ ./import/lava-import-openlava.py /opt/openlava/work/logdir/lsb.events https://OPENLAVA_SERVER/lavaFlow T0PS3CRETK3YFILE --tail_log &amp;</pre>
</div>
<p>By using the tail_log option, the importer will tail the log file waiting for new data before uploading.  Additionally,
if the log file is rotated, the script will load the new file once it has processed all data from the old one.</p>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2014, David Irvine.<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>