{% with model_name|add:" "|add:root as new_root %}
    {% for model in model_tree.itervalues %}
        {% if model.name == model_name %}
            {% for relation in model.relations %}
                {% if relation.relation not in new_root.split %}
                    {{ relation.relation }} {{ new_root.split }}
                    {% include "lavaFlow/widgets/filter_elements.html" with                        root=new_root                          previous_field=previous_field|add:"->"|add:relation.display_name                         model_tree=model_tree                         model_name=relation.relation only %}
                {% endif %}
            {% endfor %}
            {% for field in model.fields %}
                <li>
                    <a href="#" onClick="update_value_list('{{ field.filter }}'); return false;">
                        <span class="{{ field.filter }}_label">
                            {% if previous_field %}{{ previous_field }}->{%endif%}{{ field.display_name }}
                        </span>
                    </a>
                    <a href="#" class="popover_help" data-toggle="popover" title="{{ field.display_name }}" data-content="{{ field.help_text }}"><span class="glyphicon question-sign"></span></a>
                </li>
            {% endfor %}
        {% endif %}
    {% endfor %}
{% endwith %}
